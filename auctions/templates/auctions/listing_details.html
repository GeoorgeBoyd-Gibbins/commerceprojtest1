{% extends "auctions/layout.html" %}
{% block body %}

{% if message %}
<div>
    <h4>{{ message }}</h4>
</div>
{% endif %}



<main>
    <div class="container">
        <h1>LISTING DETAILS PAGE</h1>
        <h2><strong>{{ listing.listing_title }}</strong></h2>
        <div><img src="{{ listing.listing_image_url }}" class="listing-image"></div>
        <div class="following-section">
            <div class="follow-unfollow-button">
                {% if following %}
                <a href="{% url 'follow_tog' listing_id=listing_num %}" class="btn btn-primary">Un-Follow</a>
                {% else %}
                <a href="{% url 'follow_tog' listing_id=listing_num %}" class="btn btn-primary">Follow</a>
                {% endif %}
            </div>
            <div>
                <p class="Following"><i><strong>Following:</strong></i></p>
                {% if listing.following.all %}
                <ul>
                    {% for follower in listing.following.all %}
                    <li>{{ follower }}</li>
                    {% endfor %}
                </ul>
                {% else %}
                None.
                {% endif %}

            </div>
        </div>

        <div>
            <p><strong class="details-title">Details</strong></p>
        </div>
        <div>
            <p> {{ listing.listing_details }} </p>
        </div>


        <div>
            Current Price: Â£{{ listing.current_bid }}
        </div>

        <div>
            <p class="listing_time"><i><strong>Listing Time:</i></strong> {{ listing.listing_date_time }}</p>
            <p class="closing_time"><i><strong>Latest Closing Time:</i></strong> {{ listing.closing_time }}</p>
            <small>N.b. The seller can close a listing prematurely so there is no guarantee that the auction will remain
                open for this long.</small>
        </div>



        <div class="bid_history">
            <h5>Bidding History</h5>
            {% for bid in bid_history %}

            <p>{{ bid}}</p>


            {% endfor %}
        </div>

        <div>
            <form method="POST" action="{% url 'newbid' listing_id=listing_num %}">
                {% csrf_token %}
                {{ form.as_p }}
                <input type="submit" value="Submit Bid" class="btn btn-primary">
            </form>
        </div>
        <div class="comments-box form-container">
            <form action="{% url 'comment' listing_id=listing_num %}" method="POST">
                {% csrf_token %}
                <label for="comments-box">Add a Comment</label>
                <input id="comments-box" type="text" name="comment" class="input-group">
                <input class="btn btn-primary" type="submit" value="Submit">
            </form>
        </div>


</main>

{% endblock %}